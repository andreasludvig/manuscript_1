{
  "hash": "0eaf73f83ea314ba7603c8f64d8a6030",
  "result": {
    "engine": "knitr",
    "markdown": "---\nTitle: LCMS \nAuthor: Andreas Svendsen\noutput-dir: \".\"\nexecute: \n  output: false\n  warning: false\nformat:\n  html: \n    embed-resources: true\n    code-fold: TRUE\n    code-tools: \n      source: https://github.com/andreasludvig/manuscript_1/tree/main/notebooks/LCMS\n---\n\n\nSetup\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\nlibrary(readxl)\nlibrary(data.table)\nlibrary(ggplot2)\nlibrary(patchwork)\n```\n:::\n\n\n## Getting one sheet to work\n\nLoad data\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: load raw data\n#| warning: false\n\n# Ignore warnings. Just NA's as expected\nmdz_data <-\n  read_excel(\n    path = \"data_raw/230628RAVERSION_Short.xlsx\",\n    sheet = \"Hydroxymidazolam\",\n    skip = 4,\n    col_types = c(\n      \"text\", \"skip\", \"skip\", \"skip\",\n      \"skip\", \"skip\", \"skip\", \"skip\",\n      \"numeric\", \"skip\", \"skip\", \"text\",\n      \"skip\", \"skip\", \"skip\", \"skip\"\n    ),\n    col_names = c(\"sample_name\", \"amount\", \"peak_status\")\n  )\n```\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Expecting numeric in I5 / R5C9: got 'Amount'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Expecting numeric in I6 / R6C9: got 'NF'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Expecting numeric in I18 / R18C9: got 'NF'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Expecting numeric in I19 / R19C9: got 'NF'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Expecting numeric in I22 / R22C9: got 'NF'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Expecting numeric in I211 / R211C9: got 'NF'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Expecting numeric in I213 / R213C9: got 'NF'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Expecting numeric in I214 / R214C9: got 'NF'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Expecting numeric in I215 / R215C9: got 'NF'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Expecting numeric in I216 / R216C9: got 'NF'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Expecting numeric in I217 / R217C9: got 'NF'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Expecting numeric in I219 / R219C9: got 'NF'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Expecting numeric in I220 / R220C9: got 'NF'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Expecting numeric in I223 / R223C9: got 'NF'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Expecting numeric in I227 / R227C9: got 'NF'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Expecting numeric in I230 / R230C9: got 'NF'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr .hidden}\n\n```\nWarning: Expecting numeric in I232 / R232C9: got 'NF'\n```\n\n\n:::\n\n```{.r .cell-code .hidden}\n#| label: load raw data\n#| warning: false\n\n# Set as DT, and get only samples\nsetDT(mdz_data)\nmdz_data <- mdz_data[grepl(\"AS\", mdz_data$sample_name)] # get samples of interest\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n#| label: Load sample info and merge with raw dadta\n\nsample_info <- read_excel(\"data_raw/AS0013B_sample_info.xlsx\")\n\ntidy_data <- merge.data.table(mdz_data, sample_info, by = \"sample_name\")\n\n# Check dt structure\nstr(tidy_data)\n\n# Make treatment a factor\ntidy_data <- \n  tidy_data[, \n            treatment := factor(treatment,\n                                levels = c(\"control\",\n                                           \"medium\",\n                                           \"0.01 ng/ml IL-6\",\n                                           \"0.1 ng/ml IL-6\",\n                                           \"1 ng/ml IL-6\",\n                                           \"10 ng/ml IL-6\",\n                                           \"0.01 ng/ml IL-1B\",\n                                           \"0.1 ng/mI IL-1B\",\n                                           \"1 ng/ml IL-1B\",\n                                           \"10 ng/mI IL-1B\"\n                                           ),\n                                ordered = TRUE\n                                )\n            ]\n```\n:::\n\n\nCheck peak status' for any amounts below what below the limit of our standard curve.\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Check peak status'\nunique(mdz_data$peak_status)\n# Find any that is not NA\nmdz_data[!is.na(peak_status)]\n```\n:::\n\n\n#### REMEMBER TO OMIT THIS ONE \n\nCalculate mean of replicates and activity relative to vehicle control\n\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\n# Calculate the mean amount of replicates\ntidy_data[, \n          mean_amount := mean(amount, na.rm = TRUE), \n          by = .(treatment, time_treatment, time_incubation)\n          ]\n\n# Calculate amounts relative to control\ntidy_data[treatment == \"control\", \n          calibrator := mean(mean_amount), \n          by = .(treatment, time_treatment, time_incubation)\n          ]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code .hidden}\ntidy_data |> kableExtra::kable()\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}